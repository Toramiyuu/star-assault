---
phase: 01-hud-orb-clarity
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - src/systems/XPManager.js
  - src/systems/HUD.js
  - src/ui/UpgradeCardUI.js
autonomous: true
requirements:
  - VISC-01

must_haves:
  truths:
    - "XP orbs are orange/gold — visible against all six background zones including Nebula and Void Rift"
    - "The outer glow of each XP orb breathes (fades in/out) at ~0.8s period without changing orb size"
    - "Magnet pull trail lines are orange, matching the orb color"
    - "The XP level bar fill, border, and LV text are orange (not green)"
    - "Upgrade card stat text and NEW/level-dot text are orange (not green)"
  artifacts:
    - path: "src/systems/XPManager.js"
      provides: "Orange orb rendering with 0.8s glow breathe; orange magnet trail"
      contains: "0xFF6600"
    - path: "src/systems/HUD.js"
      provides: "Orange XP bar fill, border, and level text"
      contains: "0xFF6600"
    - path: "src/ui/UpgradeCardUI.js"
      provides: "Orange accent colors for stat text and level dots"
      contains: "FF8800"
  key_links:
    - from: "src/systems/XPManager.js"
      to: "_drawOrb()"
      via: "fillStyle calls on outer glow, mid ring, core"
      pattern: "fillStyle\\(0xFF6600"
    - from: "src/systems/XPManager.js"
      to: "update()"
      via: "lineStyle for magnet trail"
      pattern: "lineStyle\\(2, 0xFF6600"
    - from: "src/systems/HUD.js"
      to: "updateXPBar()"
      via: "fillStyle for xpBarFill"
      pattern: "fillStyle\\(0xFF6600"
---

<objective>
Switch all XP orb visuals from green to orange/gold — orb glow layers, idle breathe pulse, magnet trail, XP level bar, and upgrade card accents.

Purpose: Green XP orbs vanish against the Nebula and other warm-tinted background zones. Orange/gold reads as collectible reward at all six zone backgrounds, matching Survivor.io-style visual language.
Output: Three files modified with color swaps; orbs immediately recognizable against all backgrounds.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-hud-orb-clarity/01-CONTEXT.md
@.planning/phases/01-hud-orb-clarity/01-RESEARCH.md
@src/systems/XPManager.js
@src/systems/HUD.js
@src/ui/UpgradeCardUI.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Switch XP orb colors and breathe pulse in XPManager.js</name>
  <files>src/systems/XPManager.js</files>
  <action>
In `_drawOrb(gfx, orb, time)`, replace all green color references with orange equivalents and tune the breathe pulse:

1. Change pulse multiplier from `0.006` to `0.00785` (gives ~0.8s period at `time` in milliseconds: `2 * Math.PI / 800 ≈ 0.00785`).
2. Outer glow layer: `fillStyle(0x00ff88, 0.15 * pulse)` → `fillStyle(0xFF6600, 0.15 * pulse)` — keeps breathing effect on outer layer only.
3. Mid glow layer: `fillStyle(0x00ff88, 0.4 * pulse)` → `fillStyle(0xFF8800, 0.4)` — remove pulse from mid ring (outer glow handles the breathe; mid ring stays steady per CONTEXT.md "glow breathe, not a size throb").
4. Core: `fillStyle(0x88ffcc, 0.9)` → `fillStyle(0xFFAA44, 0.95)` — warm amber core.
5. White center dot: leave `fillStyle(0xffffff, 0.8)` unchanged.

In `update(time, delta)`, locate the magnet trail draw (inside the `if (dist < magnetRadius)` block):
6. `lineStyle(2, 0x00ff88, trailAlpha)` → `lineStyle(2, 0xFF6600, trailAlpha)`

No other changes. Do not alter orb physics, collection logic, or spawn behavior.
  </action>
  <verify>
    <automated>grep -n "0xFF6600\|0xFF8800\|0xFFAA44" src/systems/XPManager.js</automated>
    <manual>Run `npm run dev`, press I (god mode), press N to cycle waves. At each zone, XP orbs should appear orange/amber with a visible glow that fades in and out gently. Verify the outer ring dims and brightens — the orb diameter does NOT change. In Nebula Zone (waves 4-5, pink-red background), orbs must be clearly visible. Check magnet pull lines are orange when orbs are attracted toward player.</manual>
    <sampling_rate>After this task, before Task 2</sampling_rate>
  </verify>
  <done>XPManager.js contains `0xFF6600`, `0xFF8800`, `0xFFAA44` in _drawOrb(); magnet trail uses `0xFF6600`. No green `0x00ff88` references remain in this file.</done>
</task>

<task type="auto">
  <name>Task 2: Update XP bar and upgrade card accent colors to orange</name>
  <files>src/systems/HUD.js, src/ui/UpgradeCardUI.js</files>
  <action>
In `src/systems/HUD.js`, update three XP-related color references:

1. Constructor, `xpLevelText` creation (line 76): `color: '#00ff88'` → `color: '#FF8800'`
2. Constructor, `xpBarBg` border draw (line 89): `lineStyle(1, 0x00ff88, 0.5)` → `lineStyle(1, 0xFF6600, 0.5)`
3. `updateXPBar()` method (line 220): `fillStyle(0x00ff88, 1)` → `fillStyle(0xFF6600, 1)`

Do NOT touch the shield bar, health bar, shieldGlow, or any other part of `HUD.update()`. Only XP-related lines change here.

In `src/ui/UpgradeCardUI.js`, update two accent color references in `_createCard()`:

4. Stat text color (line 179 — the `color: '#00FF88'` inside `statText`): `'#00FF88'` → `'#FF8800'`
5. Level dots / "NEW" text color (line 204 — inside the `if (levelStr)` block): `color: isLevelUp ? '#ffcc00' : '#00ff88'` → `color: isLevelUp ? '#ffcc00' : '#FF8800'`

Do NOT alter card layout, upgrade logic, animation, or any other color in UpgradeCardUI.js.

Regarding Claude's Discretion items from CONTEXT.md:
- Kill streak counter accent: leave white/yellow as-is — it will be migrated to HUD in plan 01-02; do not touch StatBar.js in this task.
- HUD frame/border accent: skip (competing with shield/HP bar colors would be distracting).
- Wave announcement text: leave as-is (grey `#aaaaaa` is neutral and fine with orange orbs).
  </action>
  <verify>
    <automated>grep -n "FF6600\|FF8800\|00ff88\|00FF88" src/systems/HUD.js src/ui/UpgradeCardUI.js</automated>
    <manual>Run `npm run dev`. Verify: (1) XP level bar fill is orange as XP accumulates, (2) LV text is orange, (3) XP bar border line is orange. Press U (force level-up) to open upgrade cards — verify the stat value text (e.g. "+15% damage") is orange, and the "NEW" label on first-pick upgrades is orange.</manual>
    <sampling_rate>After this task completes</sampling_rate>
  </verify>
  <done>HUD.js has no `0x00ff88` / `#00ff88` in XP-related code; xpBarFill, xpBarBg border, and xpLevelText are all orange. UpgradeCardUI.js stat text and NEW/level-dot text use `#FF8800` (not `#00FF88` / `#00ff88`). Shield and health bar colors are untouched.</done>
</task>

</tasks>

<verification>
Manual browser verification sequence (use `npm run dev`):
1. Start game, enable god mode (I key)
2. Advance through waves 1-6 with N key — check orbs are orange at each background zone, especially Nebula (waves 4-5, pink background)
3. Continue to waves 12-14 — check orbs in Void Rift zone
4. Move player close to orb cluster — verify magnet trail lines are orange
5. Let XP accumulate — verify XP bar fills orange and LV text is orange
6. Press U (force level-up) — verify upgrade card stat text and NEW labels are orange

Green (`#00ff88`, `0x00ff88`, `0x88ffcc`) must not appear in XP orb rendering, XP bar, or upgrade card accents.
</verification>

<success_criteria>
- All XP orb glow layers use orange palette (0xFF6600 outer, 0xFF8800 mid, 0xFFAA44 core)
- Outer glow breathes at ~0.8s period; orb diameter does not change
- Magnet trail is orange
- XP bar (fill + border + LV text) is orange
- Upgrade card stat text and NEW/dot text are orange
- No green orb color references remain in XPManager.js, and no green XP-related colors remain in HUD.js or UpgradeCardUI.js
</success_criteria>

<output>
After completion, create `.planning/phases/01-hud-orb-clarity/01-01-SUMMARY.md`
</output>
