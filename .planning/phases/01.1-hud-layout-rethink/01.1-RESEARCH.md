# Phase 1.1: HUD Layout Rethink - Research

**Researched:** 2026-02-26
**Domain:** Phaser 3 HUD layout â€” element repositioning/resizing for mobile portrait clarity
**Confidence:** HIGH

---

## Summary

The current HUD is functionally correct but critically undersized for mobile play. Shield and HP bars are 220px wide by 14px tall at 1080px canvas resolution. When the canvas is CSS-scaled to a typical mobile viewport (~375px wide), those bars render at roughly 76px wide and ~5px tall â€” physically smaller than a matchstick. The XP bar at 400px canvas width lands at ~138px CSS-rendered â€” better but still too narrow for at-a-glance reading during wave combat. The kill streak counter and wave label use 28px and 36px font sizes respectively, which scale down to approximately 10px and 13px CSS-rendered â€” invisible without deliberate squinting.

Survivor.io's HUD conventions set the benchmark: bars occupy the top edge with prominent icon anchors, full-width or near-full-width XP bar at the bottom, and nothing at screen center. Element sizes in Survivor.io's 1080x1920 resolution equivalent are approximately 400-500px bar widths (shield/HP), 16-24px bar heights, and 40-56px font sizes for all in-play labels. Safe zones for notch/punch-hole avoidance require top and bottom padding of 120-160px from physical screen edges (120px top, 160px bottom at 1080px canvas height).

This phase is entirely additive repositioning and resizing of existing HUD.js graphics and text objects. No new Phaser APIs, no new dependencies. All repositioning targets the constants and coordinates already in HUD.js. The tween proxy pattern established in Phase 1 (gap-02, gap-03) must be preserved exactly. The primary implementation risk is the per-frame Graphics.clear() redraw that currently fires unconditionally â€” dirty-flag optimization is flagged in CONCERNS.md as deferred work but should be noted as a parallel concern.

**Primary recommendation:** Increase bar dimensions by 3-4x (to 500-600px wide, 28-36px tall), anchor the shield+HP bar cluster to the top-left safe zone (starting at y=140px), move the XP bar to the bottom safe zone (y=1750-1780px), and increase all text sizes to 48-64px for in-play labels.

---

<phase_requirements>
## Phase Requirements

| ID | Description | Research Support |
|----|-------------|-----------------|
| VISC-03 | Bottom stat bar (DMG/RATE/SPD/SH/HP/CRIT/PIER/STK) is removed from the gameplay HUD | Already completed in Phase 1 (01-02-PLAN). This phase's obligation is to confirm the bar stays gone and the replacement HUD layout fills the visual gap the bar occupied |

Note: VISC-03 is marked Complete in REQUIREMENTS.md. Phase 1.1's true obligation is the success criteria in ROADMAP.md â€” readability at mobile viewport size â€” which maps logically to VISC-03's spirit. The planner should treat this phase as producing the layout that makes VISC-03 feel fulfilled rather than merely technically satisfied.

</phase_requirements>

---

## Standard Stack

### Core
| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| Phaser 3 / 4 RC | ^4.0.0-rc.6 (project pinned) | All HUD rendering â€” Graphics, Text, Tweens | Already in use; no alternatives considered |

No new libraries needed. This phase uses only what is already in HUD.js: `scene.add.graphics()`, `scene.add.text()`, `scene.tweens.add()`, and the `setScrollFactor(0)` pattern for HUD overlay.

### No Installation Required

This phase adds no npm dependencies.

---

## Current HUD: Exact State

Reading `src/systems/HUD.js` directly, the current layout constants are:

```javascript
const BAR_W = 220;       // bar width (canvas px)
const BAR_H = 14;        // bar height (canvas px)
const BAR_X = 60;        // left edge of bars
const SHIELD_Y = 24;     // shield bar center Y
const HEALTH_Y = 44;     // HP bar center Y
const CORNER_R = 3;      // border-radius
```

**Shield + HP bar cluster:**
- Position: top-left, Y=24px (shield) and Y=44px (HP) from canvas top
- Size: 220px wide, 14px tall
- Icon: 16px emoji at X=30 â€” shield emoji (`\u{1F6E1}`) and heart emoji (`\u2764`)
- HUD dark-gradient background covers Y=0 to Y=160 (fade at 120-160)

**Wave label:**
- `GAME.WIDTH / 2, 40` â€” top-center, 36px font, grey (#aaaaaa)

**Score text:**
- `GAME.WIDTH - 40, 40` â€” top-right, 48px font, white

**XP bar:**
- Width: 400px, height: 12px, centered horizontally
- Y: 85px from canvas top
- Level text: 20px font, left-aligned within XP bar area

**Kill streak counter:**
- `GAME.WIDTH - 40, 10` â€” top-right (above score), 28px font, white

**Boss bar (when active):**
- 600px wide, 24px tall, centered at Y=110px
- Label "BOSS" at Y=92px, 22px font

### The Scaling Math

At canvas resolution 1080x1920 with `Phaser.Scale.FIT` and `CENTER_BOTH`, on a physical device with a 375px wide viewport (iPhone 14 size):

- Scale factor = 375 / 1080 = **0.347x**
- BAR_W=220px renders at **76px CSS** (~20mm physical)
- BAR_H=14px renders at **~5px CSS** (~1.3mm physical) â€” below readable threshold
- XP bar 400px renders at **139px CSS**
- Shield icon at 16px renders at **~6px CSS** â€” invisible emoji
- Score at 48px renders at **~17px CSS** â€” barely legible
- Wave label at 36px renders at **~12px CSS** â€” requires squinting

On a 430px wide viewport (iPhone 14 Pro Max):
- Scale factor = 430 / 1080 = **0.398x**
- Same measurements ~15% larger, still under the readability bar for bars and icons

---

## Survivor.io-Style HUD Conventions (from FEATURES.md)

Verified from genre research (FEATURES.md, researched 2026-02-26):

```
[Heart icon] â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘   HP    [Wave 12]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                  [gameplay]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[XP] â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ Lv.14         [Time]
```

**Key conventions, translated to 1080x1920 canvas coordinates:**

| Element | Survivor.io Convention | Target canvas size |
|---------|----------------------|-------------------|
| HP/Shield bar | Top-left, large and prominent | 500-600px wide, 28-36px tall |
| HP/Shield icon | Large icon anchoring bar left | 40-48px sprite/emoji, or replaced by label text |
| XP bar | Bottom edge, full-width or near-full | 900-1000px wide, 18-24px tall |
| Level number | Near XP bar, prominent | 36-48px font |
| Wave indicator | Top area, secondary | 40-52px font |
| Score | Top-center or top-right, secondary | 40-52px font |
| Kill streak | Top-right or near score | 36-48px font |

**Safe zones at 1080x1920:**
- Top safe zone: begin HUD elements at Y >= 120px (accounts for device notch/status bar at typical scale)
- Bottom safe zone: end HUD elements at Y <= 1780px (accounts for home indicator/nav bar)
- Left/right margins: minimum 40px from canvas edge for legible elements

---

## Architecture Patterns

### Pattern 1: Constants-First Repositioning

The existing HUD.js uses module-level constants for all layout values (`BAR_W`, `BAR_H`, `BAR_X`, `SHIELD_Y`, `HEALTH_Y`). This is the correct pattern â€” all repositioning should change these constants only. Hardcoded coordinates in methods like `updateXPBar()`, `showBossHP()`, and the constructor text positions must be extracted to constants in the same sweep.

**Current hardcoded values that need extraction (found in HUD.js):**
- XP bar: `xpBarW=400`, `xpBarH=12`, `xpBarY=85` â€” hardcoded inside `updateXPBar()` and constructor
- Boss bar: `barW=600`, `barH=24`, `barY=110` â€” hardcoded inside `showBossHP()`
- Score text: `GAME.WIDTH - 40, 40` â€” hardcoded in constructor
- Wave text: `GAME.WIDTH / 2, 40` â€” hardcoded in constructor
- Streak text: `GAME.WIDTH - 40, 10` â€” hardcoded in constructor
- XP level text: `GAME.WIDTH / 2 - 200, 85` â€” hardcoded in constructor
- HUD bg fillRect: `0, 0, GAME.WIDTH, 120` and `0, 120, GAME.WIDTH, 40` â€” hardcoded

**Target approach:** Expand the constants block at the top of HUD.js to cover all layout values, then reference them everywhere inside the class.

### Pattern 2: Preserve Tween Proxy Objects

Phase 1 established the `_shieldProxy` / `_healthProxy` pattern with the critical finding that Phaser's `GetProps.js` (line 45) silently skips tween config properties starting with `_`. The proxy objects use plain property names (`ratio`, not `_ratio`). This pattern MUST be preserved exactly when resizing bars â€” only the `BAR_W`, `BAR_H`, `BAR_X`, `SHIELD_Y`, `HEALTH_Y` constants change, the tween logic is untouched.

```javascript
// CORRECT: Phaser tweens this because 'ratio' has no underscore
this._shieldProxy = { ratio: 1 };
// WRONG: Phaser would silently skip this
this._shieldProxy = { _ratio: 1 };
```

### Pattern 3: Static Backgrounds Redrawn Once

The shield and HP bar backgrounds (`shieldBarBg`, `healthBarBg`) are drawn once in the constructor via `_drawBarBg()`. When constants change, these will auto-use the new values because they reference the module-level constants. No special handling needed â€” but verify `_drawBarBg()` uses `BAR_X`, `BAR_H`, etc. (it does, confirmed from source).

The HUD dark gradient background (`hudBg`) is drawn once in the constructor with hardcoded `0, 0, GAME.WIDTH, 120` and `0, 120, GAME.WIDTH, 40`. This must be updated to cover the new top-area height (taller bars + larger fonts will push the shield/HP cluster down, requiring more gradient coverage).

### Pattern 4: XP Bar Repositioned to Bottom

Moving the XP bar from Y=85 (top area) to Y~1760 (bottom) requires:
1. Moving the `xpBarBg` static background draw from constructor to bottom position
2. Moving the `xpBarFill` calls in `updateXPBar()` to use new Y constant
3. Moving the `xpLevelText` text object position
4. The `hudBg` gradient at top becomes simpler (only shield/HP/score/wave area)
5. A new bottom gradient is needed behind the XP bar

### Pattern 5: setScrollFactor(0) on All HUD Objects

All HUD elements must have `.setScrollFactor(0)` â€” already applied to all existing objects. When any new graphics/text objects are created during repositioning (e.g., new XP bar background at bottom), this call is mandatory.

### Anti-Patterns to Avoid

- **Repositioning via setPosition on Graphics objects:** Phaser 3 Graphics objects do not meaningfully support `setPosition` to offset their draw calls. Coordinates must be changed in the `fillRect`/`fillRoundedRect` calls directly. Attempting to `gfx.setPosition(newX, newY)` and keep old draw coordinates will misplace the element.
- **Forgetting to redraw static bars after constant changes:** `shieldBarBg` and `healthBarBg` are drawn once in the constructor. If the constants change but the constructor draw order doesn't, the static backgrounds will be at wrong size/position while the animated fill is at new size/position.
- **XP bar width/height duplication:** The XP bar dimensions are currently duplicated between the constructor (background draw) and `updateXPBar()` (fill draw). These must be consistent â€” extract to constants and reference in both places.

---

## Don't Hand-Roll

| Problem | Don't Build | Use Instead | Why |
|---------|-------------|-------------|-----|
| Responsive scaling | Custom scale math or viewport detection | `Phaser.Scale.FIT` already handles scaling | Phaser's Scale Manager already handles FIT scaling; canvas coordinate system is fixed at 1080x1920 |
| Separate UIScene overlay | Second Phaser scene for HUD | Keep single-scene HUD | REQUIREMENTS.md explicitly out-of-scopes "Separate UIScene for HUD"; single-scene is correct |
| CSS/DOM HUD overlay | HTML elements positioned over canvas | All in canvas | Breaks on different viewport sizes; canvas coordinate system is the correct target |

**Key insight:** All coordinate changes are in the 1080x1920 canvas coordinate space. The physical size on device is governed entirely by the scale factor â€” designers work in canvas pixels, Phaser handles the rest.

---

## Common Pitfalls

### Pitfall 1: Emoji Icons Render Differently Per OS

**What goes wrong:** The shield emoji (`\u{1F6E1}`, ðŸ›¡ï¸) and heart emoji (`\u2764`, â¤ï¸) are currently used as 16px `scene.add.text()` icons. At 16px canvas size these are already nearly invisible. Enlarging them (e.g., to 48px) will surface a known mobile inconsistency: iOS renders these emoji as full-color images, Android may render them as outlined/monochrome variants, and some Android versions show a different color than expected.

**How to avoid:** Replace emoji icons with one of:
- Unicode block characters (`â–®`, `â™¥`) that render consistently as text across platforms
- ASCII-art styled Phaser text that uses the same font family as all other HUD text
- Or simply replace the icon with a color-coded label ("SH:" / "HP:") using matching bar colors

**Warning signs:** Icon looks great in browser DevTools Device Mode but different on a physical Android device.

### Pitfall 2: XP Bar Y-Position Conflict with Upgrade Card UI

**What goes wrong:** The `UpgradeCardUI.js` shows cards stacked vertically during level-up. The CONTEXT.md from Phase 1 (01-CONTEXT.md) references "vertical 920x260 stacked cards". If the XP bar is relocated to the bottom (~Y=1760), there is a risk of overlap with the bottom card during card selection screens.

**How to avoid:** Check `UpgradeCardUI.js` for its card stack origin Y. If cards start from Y=1200 or lower, verify the lowest card does not reach Y=1760. The XP bar is hidden/irrelevant during `upgradePaused=true` state so visual overlap is tolerable, but worth checking.

**Warning signs:** During playtesting of level-up cards, the XP bar is visible through the card overlay.

### Pitfall 3: HUD Background Gradient Not Covering New Layout

**What goes wrong:** The current `hudBg` gradient covers `fillRect(0, 0, GAME.WIDTH, 120)` with fade at 120-160. If bars grow from 14px to 36px tall and the cluster moves down to Y=160, the dark background that makes bars readable against gameplay backgrounds no longer covers them.

**How to avoid:** Compute the required hudBg coverage from the new constants (shield Y + bar height + padding) and update the two `fillRect` calls in the constructor accordingly.

### Pitfall 4: Per-Frame Graphics Redraw Not Addressed

**What goes wrong:** CONCERNS.md flags HUD `update()` as calling `clear()+redraw` every frame even for static values. With bigger bars (more area to fill), the per-frame render cost increases proportionally. PITFALLS.md budgets under 3ms total for all custom drawing on mobile â€” the current HUD already wastes this on a static bar on unchanged frames.

**How to avoid:** The dirty-flag pattern is already partially in place (`_shieldRatioTarget` and `_healthRatioTarget` prevent retweening, but the `clear()+fill` still runs every frame). During this phase, do NOT ignore this: add a guard that skips `shieldBarFill.clear()` and `healthBarFill.clear()` when the proxy ratio hasn't changed since last frame. The shield glow (recharge pulse) still needs per-frame redraw, but the fill bars do not.

**This is a required fix in Phase 1.1, not a deferral** â€” enlarging the bars without fixing the per-frame redraw makes the performance problem proportionally worse.

### Pitfall 5: Boss Bar Collides with Enlarged Top HUD

**What goes wrong:** The boss bar is positioned at Y=110px in the canvas. If the shield+HP cluster is moved to Y=140-200px, the boss bar (at Y=110, height 24px) will overlap with or sit directly above the new shield/HP bars with no visual separation.

**How to avoid:** Also update boss bar Y when repositioning the top HUD. Boss bar should sit above or below the shield/HP cluster with clear visual separation. One approach: boss bar at bottom of the top HUD region, below the XP bar (if XP bar stays top), or at Y=200+ when XP moves to bottom.

---

## Code Examples

### Proposed New Layout Constants (reference, not final)

```javascript
// Proposed constants for 1080x1920 at Survivor.io-equivalent readability
const BAR_W = 560;        // was 220 â€” readable at 375px viewport: 194px CSS
const BAR_H = 30;         // was 14 â€” readable at 375px viewport: ~10px CSS
const BAR_X = 80;         // was 60 â€” more breathing room from edge
const SHIELD_Y = 160;     // was 24 â€” below notch safe zone, below score row
const HEALTH_Y = 200;     // was 44 â€” 40px gap between bars
const CORNER_R = 6;       // was 3 â€” proportional to larger bars

const XP_BAR_W = 920;     // was 400 â€” near full-width
const XP_BAR_H = 20;      // was 12 â€” readable
const XP_BAR_X = (GAME.WIDTH - XP_BAR_W) / 2;  // centered
const XP_BAR_Y = 1760;    // was 85 â€” bottom safe zone
```

At these values, on 375px viewport:
- BAR_W 560px * 0.347 = **194px CSS** (readable bar)
- BAR_H 30px * 0.347 = **~10px CSS** (visible, functional bar)
- XP_BAR_W 920px * 0.347 = **319px CSS** (spans most of screen width)

### Repositioning a Phaser Graphics Draw

Graphics objects draw relative to the canvas origin, not their own position. To move a drawn element:

```javascript
// CORRECT: change the coordinates in the draw call
this.shieldBarFill.fillRoundedRect(
    BAR_X + 1,               // x (constant reference)
    SHIELD_Y - BAR_H / 2 + 1, // y (constant reference)
    (BAR_W - 2) * this._shieldProxy.ratio,
    BAR_H - 2,
    CORNER_R
);

// WRONG: attempting to offset a Graphics object via setPosition
this.shieldBarFill.setPosition(newX, newY); // does not offset draw calls
```

### Dirty-Flag Fill Bar Optimization Pattern

```javascript
// Add to HUD constructor:
this._lastShieldRatioDrawn = -1;
this._lastHealthRatioDrawn = -1;

// In update(), before shieldBarFill.clear():
const shieldRatioNow = this._shieldProxy.ratio;
if (shieldRatioNow !== this._lastShieldRatioDrawn) {
    this._lastShieldRatioDrawn = shieldRatioNow;
    this.shieldBarFill.clear();
    // ... draw fill ...
}
// shieldGlow still redraws every frame (pulse animation needs it)
```

### Text Repositioning (setPosition IS valid for Text objects)

```javascript
// Text objects support setPosition() correctly
this.waveText.setPosition(GAME.WIDTH / 2, 80);
this.waveText.setFontSize('52px');

// Or declare new text with updated coordinates â€” either works
```

---

## State of the Art

| Old Approach | Current Approach | Notes |
|--------------|------------------|-------|
| StatBar 8-stat bottom strip | Removed in Phase 1 | Gap now free for gameplay visibility |
| Green XP orbs | Orange XP orbs (Phase 1) | Color contrast solved |
| Proxy-less bar fill (jump-cut) | Tween proxy pattern (Phase 1) | Animations working â€” preserve in this phase |
| BAR_W=220, BAR_H=14 | Target: BAR_W=~560, BAR_H=~30 | This phase |
| XP bar at Y=85 (top area) | Target: Y=~1760 (bottom) | This phase |

---

## Open Questions

1. **Exact bar dimensions â€” designer judgment call**
   - What we know: 220x14 is too small; 560x30 is readable; the right value is somewhere in this range and should be tested visually in-browser with DevTools set to 375px wide
   - What's unclear: Whether 560px wide bars look proportionate alongside the 1080px canvas width, especially with the icon to the left
   - Recommendation: Start at 500px wide, 28px tall â€” verify in browser at 375px viewport width, adjust before committing

2. **Icon approach â€” emoji vs. text vs. skip icons**
   - What we know: Current emoji icons (16px) are invisible at scale; emoji render inconsistently across mobile OS
   - What's unclear: Whether the user wants to replace with consistent Unicode characters, color-coded text labels, or small pre-generated sprite icons
   - Recommendation: Replace with short text labels styled in the bar's accent color: "SHIELD" or "SH" in blue (#4488ff) and "HP" in red (#ff4444), 28-32px font. This is OS-consistent and readable. Emoji can be revisited if users prefer them.

3. **XP bar placement â€” top vs. bottom**
   - What we know: Survivor.io places XP at the bottom. Current top-area placement is cluttered (bars + XP bar + boss bar all compete in the top 120px)
   - What's unclear: Whether boss bar + XP bar at the same top position (current) should be resolved by moving XP to bottom or by enlarging the top-area HUD region
   - Recommendation: Move XP bar to bottom safe zone (~Y=1760). This separates the "status" (HP/Shield, top) from the "progression" (XP/Level, bottom) â€” the Survivor.io convention.

4. **Kill streak counter placement**
   - What we know: Currently top-right at Y=10 above score. Enlarging score text and moving bars down may create a crowded top-right.
   - Recommendation: Place streak counter top-right, with score directly below it, using consistent Y anchor.

---

## Validation Architecture

### Test Framework

| Property | Value |
|----------|-------|
| Framework | None configured â€” no test files, no test config |
| Config file | None â€” Wave 0 gap |
| Quick run command | N/A â€” no framework installed |
| Full suite command | N/A |
| Estimated runtime | N/A |

Note: `package.json` has no test script. No `*.test.*` files exist anywhere in `src/`. No vitest/jest config detected. Puppeteer is installed as a devDependency but unused.

### Phase Requirements -> Test Map

| Req ID | Behavior | Test Type | Automated Command | File Exists? |
|--------|----------|-----------|-------------------|-------------|
| VISC-03 (success criteria 1) | Shield/HP bars visible at 375px viewport width | manual | Open browser DevTools at 375px, observe bars during wave | N/A â€” manual only |
| VISC-03 (success criteria 2) | No HUD elements obscuring center play area | manual | Play to wave 3, observe no HUD overlap with enemies | N/A â€” manual only |
| VISC-03 (success criteria 3) | XP bar and streak legible without pausing | manual | Play to level 3, read XP/streak during combat | N/A â€” manual only |
| VISC-03 (success criteria 4) | Survivor.io-style layout conventions met | manual | Screenshot comparison against reference | N/A â€” manual only |

This phase is fundamentally visual â€” all acceptance criteria require human visual inspection at actual or simulated mobile resolution. There is no automated test that can validate "legible at a glance." The correct verification approach is the existing Puppeteer devDependency (could render a game frame and screenshot it) but this is not wired up.

### Nyquist Sampling Rate

- **Minimum sample interval:** After each layout constant change â€” reload game in browser at 375px DevTools width and visually confirm bar size
- **Full suite trigger:** N/A â€” no test suite
- **Phase-complete gate:** Manual verification: run game, play to wave 3, confirm all four success criteria from ROADMAP.md
- **Estimated feedback latency per task:** ~30 seconds (browser reload + observe)

### Wave 0 Gaps

No test infrastructure exists at all. For this phase (pure visual repositioning), the minimum viable validation is manual browser testing â€” no Wave 0 gap must be filled before implementation can begin. The planner should include a verification task that requires a browser reload and visual confirmation after each layout change.

If the project ever introduces Puppeteer-based screenshot diffing, the gap would be:
- [ ] `scripts/test-hud-layout.js` â€” Puppeteer screenshot at 375px width, manual review
- [ ] Framework install: `npm install --save-dev puppeteer` â€” already installed per package.json

*(Puppeteer is already installed â€” the gap is a test script, not installation)*

---

## Sources

### Primary (HIGH confidence)
- `src/systems/HUD.js` â€” read directly; all current constants, positions, sizes
- `src/main.js` â€” confirmed `Phaser.Scale.FIT`, canvas 1080x1920
- `.planning/codebase/CONCERNS.md` â€” per-frame HUD redraw issue documented at lines 111-114
- `.planning/research/FEATURES.md` â€” Survivor.io HUD layout (genre research 2026-02-26)
- `.planning/research/PITFALLS.md` â€” pitfall #1 (per-frame Graphics redraw), #3 (visual noise), UX pitfalls table
- `.planning/STATE.md` â€” Phase 1 decisions: tween proxy pattern, underscore bug, gap closures
- `package.json` â€” Phaser 4.0.0-rc.6 pinned, Puppeteer installed, no test framework

### Secondary (MEDIUM confidence)
- `.planning/research/FEATURES.md` â€” Survivor.io bar width conventions (genre analysis, not verified against Survivor.io source)
- MEMORY.md â€” game is 1080x1920, Phaser.Scale.FIT confirmed

### Tertiary (LOW confidence)
- Scale factor math (1080 -> 375px viewport = 0.347x) â€” computed, not verified against a physical device; actual rendering may vary 5-10% depending on browser chrome/safe area handling

---

## Metadata

**Confidence breakdown:**
- Current HUD state: HIGH â€” read directly from source
- Required size changes: MEDIUM â€” Survivor.io conventions from genre research, not verified on device
- Phaser API patterns: HIGH â€” confirmed from codebase (tween proxy, Graphics draw pattern)
- Pitfalls: HIGH â€” drawn from CONCERNS.md and PITFALLS.md which are codebase-verified
- Safe zone numbers: MEDIUM â€” standard mobile safe zone values (120px top, 160px bottom) from general mobile UX knowledge; not device-verified

**Research date:** 2026-02-26
**Valid until:** 2026-03-26 (stable domain â€” no breaking Phaser API changes expected in 30 days given RC pinned version)
